# Hanna AI Nurse - Complete User Journey Wireframe (Updated)

**Last Updated**: December 1, 2025  
**Version**: 2.0 - Gemini Live Integration

---

## ğŸ¯ User Personas

### Primary Users
1. **Patient** (Elderly with chronic diabetes)
2. **Family Member** (Adult child monitoring parent)
3. **Nurse/Admin** (Healthcare provider oversight)

---

## ğŸ—ï¸ System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PATIENT TOUCHPOINTS                   â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  LINE Chat   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  Hanna Web   â”‚         â”‚
â”‚  â”‚     Bot      â”‚   LIFF Link  â”‚  (Gemini Live)â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚       â”‚                              â”‚                   â”‚
â”‚       â”‚ Webhook                      â”‚ WebSocket         â”‚
â”‚       â–¼                              â–¼                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚         Hanna Backend Server             â”‚           â”‚
â”‚  â”‚  â€¢ Message Router                        â”‚           â”‚
â”‚  â”‚  â€¢ Gemini Live Service                   â”‚           â”‚
â”‚  â”‚  â€¢ Database (Supabase)                   â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Conversation Modes

| Mode | Channel | Use Case | Conversational Quality |
|------|---------|----------|----------------------|
| **Async Care** | LINE Bot | Daily check-ins, reminders, logging | â­â­â­ (Menu-driven) |
| **Live Conversation** | Gemini Live (LIFF) | Real-time consultation, urgent care | â­â­â­â­â­ (True conversation) |

---

## ğŸ“± Patient Journey

### Phase 1: Discovery & Onboarding (Day 0)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User scans QR code / searches @519fietsâ”‚
â”‚  â†“                                       â”‚
â”‚  [Follow Event Triggered]                â”‚
â”‚  â†“                                       â”‚
â”‚  âœ¨ Welcome Message                      â”‚
â”‚  \"à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°! à¸®à¸±à¸™à¸™à¸²à¹€à¸­à¸‡à¸™à¸°à¸„à¸°...\"           â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ“ Onboarding Flow                      â”‚
â”‚  Step 1: Name                            â”‚
â”‚  Step 2: Age                             â”‚
â”‚  Step 3: Diabetes Type                   â”‚
â”‚  Step 4: Monitoring Frequency            â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ Trial Offer (Flex Message)           â”‚
â”‚  [Start Free Trial] [View Paid Plans]    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Decision Point:**
- **Option A**: User clicks "Start Free Trial" â†’ Go to Phase 2
- **Option B**: User clicks "View Paid Plans" â†’ Go to Payment Flow

---

### Phase 2: Active Trial (Day 1-14)

#### Daily Routine - LINE Bot (Async)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸŒ… 8:00 AM - Morning Check-in           â”‚
â”‚  \"à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸Šà¹‰à¸²à¸„à¹ˆà¸° à¸„à¸¸à¸“{name}!\"          â”‚
â”‚  \"à¸§à¸±à¸™à¸™à¸µà¹‰à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£à¸šà¹‰à¸²à¸‡à¸„à¸°?\"            â”‚
â”‚  â†“                                       â”‚
â”‚  User responds (text/voice)              â”‚
â”‚  â†“                                       â”‚
â”‚  Hanna logs response to database         â”‚
â”‚                                          â”‚
â”‚  ğŸŒ™ 7:00 PM - Medication Reminder        â”‚
â”‚  \"à¸–à¸¶à¸‡à¹€à¸§à¸¥à¸²à¸à¸´à¸™à¸¢à¸²à¹à¸¥à¹‰à¸§à¸™à¸°à¸„à¸° ğŸ’Š\"              â”‚
â”‚  [à¸à¸´à¸™à¹à¸¥à¹‰à¸§ âœ…] [à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸à¸´à¸™]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Live Conversation - Gemini Live (Real-time)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User needs to talk to Hanna             â”‚
â”‚  â†“                                       â”‚
â”‚  LINE Bot detects urgency/request        â”‚
â”‚  \"à¸®à¸±à¸™à¸™à¸²à¸­à¸¢à¸²à¸à¸„à¸¸à¸¢à¸à¸±à¸šà¸„à¸¸à¸“à¹à¸šà¸šà¹€à¸ªà¸µà¸¢à¸‡à¸„à¹ˆà¸°\"        â”‚
â”‚  [ğŸ™ï¸ à¸„à¸¸à¸¢à¸à¸±à¸šà¸®à¸±à¸™à¸™à¸²à¹€à¸¥à¸¢]                    â”‚
â”‚  â†“                                       â”‚
â”‚  Opens LIFF (Hanna Web)                  â”‚
â”‚  â†“                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚   Hanna Live Interface      â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚   [Hanna Avatar]            â”‚         â”‚
â”‚  â”‚   \"à¸à¸³à¸¥à¸±à¸‡à¸Ÿà¸±à¸‡...\"             â”‚         â”‚
â”‚  â”‚                             â”‚         â”‚
â”‚  â”‚   [ğŸ¤ Hold to Talk]         â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â†“                                       â”‚
â”‚  User: \"à¸®à¸±à¸™à¸™à¸²à¸„à¹ˆà¸° à¸§à¸±à¸™à¸™à¸µà¹‰à¸™à¹‰à¸³à¸•à¸²à¸¥ 180\"      â”‚
â”‚  â†“ (Real-time WebSocket)                 â”‚
â”‚  Hanna: \"à¸™à¹‰à¸³à¸•à¸²à¸¥à¸ªà¸¹à¸‡à¸™à¸´à¸”à¸™à¸¶à¸‡à¸™à¸°à¸„à¸°...\"        â”‚
â”‚  â†“                                       â”‚
â”‚  Conversation continues naturally        â”‚
â”‚  â†“                                       â”‚
â”‚  [à¸§à¸²à¸‡à¸ªà¸²à¸¢] â†’ Back to LINE                â”‚
â”‚  â†“                                       â”‚
â”‚  Conversation summary saved to DB        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Trial Reminders:**
```
Day 10 (4 days left):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’š Gentle Reminder                      â”‚
â”‚  \"à¸Šà¹ˆà¸§à¸‡à¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¹€à¸«à¸¥à¸·à¸­à¸­à¸µà¸ 4 à¸§à¸±à¸™à¸„à¹ˆà¸°\"        â”‚
â”‚  [à¸ªà¸¡à¸±à¸„à¸£à¹à¸à¹‡à¸„à¹€à¸à¸ˆ] [à¸¢à¸±à¸‡à¹„à¸¡à¹ˆà¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Day 12 (2 days left):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â° Urgent Reminder                      â”‚
â”‚  \"à¹€à¸«à¸¥à¸·à¸­à¹€à¸§à¸¥à¸²à¸­à¸µà¸ 2 à¸§à¸±à¸™\"                   â”‚
â”‚  [à¸ªà¸¡à¸±à¸„à¸£à¹€à¸¥à¸¢! à¸¿2,999/à¹€à¸”à¸·à¸­à¸™]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Day 14 (Last day):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸš¨ Final Warning                        â”‚
â”‚  \"à¸§à¸±à¸™à¸ªà¸¸à¸”à¸—à¹‰à¸²à¸¢!\"                          â”‚
â”‚  [à¸ªà¸¡à¸±à¸„à¸£à¸—à¸±à¸™à¸—à¸µ! à¸¿2,999/à¹€à¸”à¸·à¸­à¸™]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Phase 3A: Subscription (Paid User)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User clicks \"Subscribe\"                 â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ“¦ Plan Selection                       â”‚
â”‚  \"à¹à¸à¹‡à¸„à¹€à¸à¸ˆ Basic à¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™\"                â”‚
â”‚  \"à¸¢à¸­à¸”à¸Šà¸³à¸£à¸°: à¸¿2,999\"                       â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ’³ PromptPay QR Code                    â”‚
â”‚  [QR Image displayed]                    â”‚
â”‚  â†“                                       â”‚
â”‚  User scans & pays via banking app       â”‚
â”‚  â†“                                       â”‚
â”‚  [à¹‚à¸­à¸™à¹à¸¥à¹‰à¸§ âœ…] (Quick Reply)              â”‚
â”‚  â†“                                       â”‚
â”‚  âœ… Confirmation                         â”‚
â”‚  \"à¸‚à¸­à¸šà¸„à¸¸à¸“à¸„à¹ˆà¸°! à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸¢à¸­à¸”à¹€à¸‡à¸´à¸™à¹€à¸£à¸µà¸¢à¸šà¸£à¹‰à¸­à¸¢\"   â”‚
â”‚  â†“                                       â”‚
â”‚  Status: 'active'                        â”‚
â”‚  â†’ Continue to Phase 4                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Phase 3B: Trial Expiration (Unpaid User)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Day 15: Trial Expires                   â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ˜¢ Expiration Message                   â”‚
â”‚  \"à¸Šà¹ˆà¸§à¸‡à¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¹à¸¥à¹‰à¸§à¸„à¹ˆà¸°\"           â”‚
â”‚  [à¸ªà¸¡à¸±à¸„à¸£à¹ƒà¸Šà¹‰à¸šà¸£à¸´à¸à¸²à¸£ à¸¿2,999/à¹€à¸”à¸·à¸­à¸™]          â”‚
â”‚  â†“                                       â”‚
â”‚  Status: 'expired'                       â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ”‡ Service Paused:                      â”‚
â”‚  - No morning check-ins                  â”‚
â”‚  - No medication reminders               â”‚
â”‚  - No Gemini Live access                 â”‚
â”‚  - Bot still responds to messages        â”‚
â”‚  â†“                                       â”‚
â”‚  If user messages:                       â”‚
â”‚  \"à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°! à¸Šà¹ˆà¸§à¸‡à¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸«à¸¡à¸”à¸­à¸²à¸¢à¸¸à¹à¸¥à¹‰à¸§\"   â”‚
â”‚  [à¸ªà¸¡à¸±à¸„à¸£à¹à¸à¹‡à¸„à¹€à¸à¸ˆ ğŸ’³]                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Reactivation Path:**
User can click "Subscribe" anytime â†’ Go to Phase 3A

---

### Phase 4: Active Subscription (Ongoing)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Daily Routine:                          â”‚
â”‚                                          â”‚
â”‚  LINE Bot (Async):                       â”‚
â”‚  - 8:00 AM: Morning check-in             â”‚
â”‚  - 7:00 PM: Medication reminder          â”‚
â”‚  - Health data logging                   â”‚
â”‚  - Quick questions                       â”‚
â”‚                                          â”‚
â”‚  Gemini Live (Real-time):                â”‚
â”‚  - Urgent consultations                  â”‚
â”‚  - Complex symptom discussions           â”‚
â”‚  - Emotional support                     â”‚
â”‚  - Detailed health reviews               â”‚
â”‚                                          â”‚
â”‚  Smart Routing:                          â”‚
â”‚  - Bot detects when live chat needed     â”‚
â”‚  - Auto-suggests LIFF link               â”‚
â”‚  - Seamless handoff                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Monthly Renewal:**
```
Day 28 of subscription:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ’³ Renewal Reminder                     â”‚
â”‚  \"à¸šà¸£à¸´à¸à¸²à¸£à¸ˆà¸°à¸•à¹ˆà¸­à¸­à¸²à¸¢à¸¸à¹ƒà¸™à¸­à¸µà¸ 2 à¸§à¸±à¸™à¸„à¹ˆà¸°\"        â”‚
â”‚  [à¸•à¹ˆà¸­à¸­à¸²à¸¢à¸¸ à¸¿2,999] [à¸¢à¸à¹€à¸¥à¸´à¸]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ™ï¸ Gemini Live Conversation Flow (Detailed)

### User Experience

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1: User opens LIFF                 â”‚
â”‚  â†“                                       â”‚
â”‚  WebSocket connects to backend           â”‚
â”‚  Backend connects to Gemini Live API     â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸³à¸¥à¸±à¸‡à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­...\"             â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸£à¹‰à¸­à¸¡à¸£à¸±à¸šà¸Ÿà¸±à¸‡\"                   â”‚
â”‚  â†“                                       â”‚
â”‚  Hanna greets: \"à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸° à¸®à¸±à¸™à¸™à¸²...\"     â”‚
â”‚  (Auto-plays voice)                      â”‚
â”‚  â†“                                       â”‚
â”‚  Step 2: User presses mic button         â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸³à¸¥à¸±à¸‡à¸Ÿà¸±à¸‡...\"                   â”‚
â”‚  Mic icon turns red                      â”‚
â”‚  Ripple animation                        â”‚
â”‚  â†“                                       â”‚
â”‚  User speaks: \"à¸§à¸±à¸™à¸™à¸µà¹‰à¸™à¹‰à¸³à¸•à¸²à¸¥ 180\"        â”‚
â”‚  â†“                                       â”‚
â”‚  Step 3: User releases button            â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸³à¸¥à¸±à¸‡à¸„à¸´à¸”...\"                   â”‚
â”‚  Audio sent to Gemini Live               â”‚
â”‚  â†“                                       â”‚
â”‚  Step 4: Hanna responds                  â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸³à¸¥à¸±à¸‡à¸à¸¹à¸”...\"                   â”‚
â”‚  Audio streams back in real-time         â”‚
â”‚  Avatar pulses with speech               â”‚
â”‚  â†“                                       â”‚
â”‚  Hanna: \"à¸™à¹‰à¸³à¸•à¸²à¸¥à¸ªà¸¹à¸‡à¸™à¸´à¸”à¸™à¸¶à¸‡à¸™à¸°à¸„à¸°...\"        â”‚
â”‚  â†“                                       â”‚
â”‚  Status: \"à¸à¸£à¹‰à¸­à¸¡à¸£à¸±à¸šà¸Ÿà¸±à¸‡\"                   â”‚
â”‚  â†“                                       â”‚
â”‚  Conversation continues...               â”‚
â”‚  â†“                                       â”‚
â”‚  User clicks \"à¸§à¸²à¸‡à¸ªà¸²à¸¢\"                    â”‚
â”‚  â†“                                       â”‚
â”‚  WebSocket closes                        â”‚
â”‚  Returns to LINE chat                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Technical Flow

```
Client (LIFF)          Backend              Gemini Live API
     â”‚                    â”‚                        â”‚
     â”‚â”€â”€WebSocketâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
     â”‚   connect          â”‚                        â”‚
     â”‚                    â”‚â”€â”€WebSocketâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                    â”‚   connect              â”‚
     â”‚                    â”‚                        â”‚
     â”‚                    â”‚â—„â”€â”€setup completeâ”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚â—„â”€â”€readyâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                        â”‚
     â”‚                    â”‚                        â”‚
     â”‚                    â”‚â”€â”€send greetingâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                    â”‚                        â”‚
     â”‚                    â”‚â—„â”€â”€audio chunksâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚â—„â”€â”€audio chunksâ”€â”€â”€â”€â”€â”‚                        â”‚
     â”‚   (plays voice)    â”‚                        â”‚
     â”‚                    â”‚                        â”‚
     â”‚â”€â”€audio dataâ”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
     â”‚   (user speech)    â”‚â”€â”€audio dataâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
     â”‚                    â”‚                        â”‚
     â”‚                    â”‚â—„â”€â”€audio responseâ”€â”€â”€â”€â”€â”€â”€â”‚
     â”‚â—„â”€â”€audio responseâ”€â”€â”€â”‚                        â”‚
     â”‚   (Hanna voice)    â”‚                        â”‚
     â”‚                    â”‚                        â”‚
     â”‚â”€â”€closeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                        â”‚
     â”‚                    â”‚â”€â”€closeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
```

---

## ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ Family Member Journey (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Family adds Hanna to group chat         â”‚
â”‚  â†“                                       â”‚
â”‚  Hanna sends daily summary:              â”‚
â”‚  \"ğŸ“Š à¸ªà¸£à¸¸à¸›à¸ªà¸¸à¸‚à¸ à¸²à¸à¸„à¸¸à¸“à¹à¸¡à¹ˆà¸§à¸±à¸™à¸™à¸µà¹‰\"             â”‚
â”‚  - Blood sugar: 120 mg/dL                â”‚
â”‚  - Medication: âœ… Taken                  â”‚
â”‚  - Mood: Good                            â”‚
â”‚  - Hanna Live sessions: 1                â”‚
â”‚  â†“                                       â”‚
â”‚  If alert triggered:                     â”‚
â”‚  \"âš ï¸ à¸„à¸¸à¸“à¹à¸¡à¹ˆà¹„à¸¡à¹ˆà¸ªà¸šà¸²à¸¢ à¸„à¸§à¸£à¸à¸²à¸à¸šà¹à¸à¸—à¸¢à¹Œ\"        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ‘©â€âš•ï¸ Nurse Dashboard Journey (Future)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Web Dashboard (hannah-dashboard)        â”‚
â”‚  â†“                                       â”‚
â”‚  ğŸ“‹ Patient Queue                        â”‚
â”‚  - High Risk (Red)                       â”‚
â”‚  - Medium Risk (Yellow)                  â”‚
â”‚  - Stable (Green)                        â”‚
â”‚  â†“                                       â”‚
â”‚  Click patient â†’ View Timeline           â”‚
â”‚  - Daily check-ins (LINE)                â”‚
â”‚  - Live conversations (Gemini Live)      â”‚
â”‚  - Medication adherence                  â”‚
â”‚  - Vitals history                        â”‚
â”‚  â†“                                       â”‚
â”‚  Nurse Actions:                          â”‚
â”‚  [Send Message] [Schedule Call] [Alert]  â”‚
â”‚  [View Conversation Transcript]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ State Diagram

```
                    [New User]
                        â†“
                  [Onboarding]
                        â†“
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â†“                   â†“
          [Trial]            [Paid Monthly]
              â†“                   â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
    â†“                   â†“        â”‚
[Expired]          [Subscribe]â”€â”€â”€â”˜
    â†“                   
[Reactivate]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Channel Access by Status:
- Trial: LINE Bot âœ…, Gemini Live âœ…
- Active: LINE Bot âœ…, Gemini Live âœ…
- Expired: LINE Bot âš ï¸ (limited), Gemini Live âŒ
```

---

## ğŸ“Š Database States

| Status       | Description                    | LINE Bot | Gemini Live | Services Active?          |
|--------------|--------------------------------|----------|-------------|---------------------------|
| `onboarding` | Collecting user info           | âœ…       | âŒ          | âŒ No                     |
| `trial`      | 14-day free trial              | âœ…       | âœ…          | âœ… Yes (Full)             |
| `active`     | Paid subscription              | âœ…       | âœ…          | âœ… Yes (Full + Premium)   |
| `expired`    | Trial ended, no payment        | âš ï¸       | âŒ          | âš ï¸ Partial (responds only)|
| `cancelled`  | User cancelled subscription    | âŒ       | âŒ          | âŒ No                     |

---

## ğŸ¨ Key Screens

### Screen 1: Welcome (LINE)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ¨ à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¹ˆà¸°! à¸®à¸±à¸™à¸™à¸²à¹€à¸­à¸‡à¸™à¸°à¸„à¸°      â”‚
â”‚ à¸à¸¢à¸²à¸šà¸²à¸¥à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§à¸‚à¸­à¸‡à¸„à¸¸à¸“ ğŸ’š          â”‚
â”‚                                 â”‚
â”‚ à¸®à¸±à¸™à¸™à¸²à¸à¸£à¹‰à¸­à¸¡à¸”à¸¹à¹à¸¥à¸ªà¸¸à¸‚à¸ à¸²à¸à¸„à¸¸à¸“à¹ƒà¸«à¹‰à¸”à¸µà¸‚à¸¶à¹‰à¸™â”‚
â”‚ à¸—à¸¸à¸à¸§à¸±à¸™à¸„à¹ˆà¸°                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Screen 2: Trial Offer (Flex Message)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [Hero Image: Medical care]      â”‚
â”‚                                 â”‚
â”‚ à¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸Ÿà¸£à¸µ 14 à¸§à¸±à¸™              â”‚
â”‚ à¹ƒà¸«à¹‰à¸®à¸±à¸™à¸™à¸²à¸Šà¹ˆà¸§à¸¢à¸”à¸¹à¹à¸¥à¸„à¸¸à¸“à¸•à¸±à¹‰à¸‡à¹à¸•à¹ˆà¸§à¸±à¸™à¸™à¸µà¹‰ â”‚
â”‚                                 â”‚
â”‚ âœ… à¹‚à¸—à¸£à¹€à¸Šà¹‡à¸„à¸ªà¸¸à¸‚à¸ à¸²à¸à¸—à¸¸à¸à¹€à¸Šà¹‰à¸²          â”‚
â”‚ âœ… à¹€à¸•à¸·à¸­à¸™à¸à¸´à¸™à¸¢à¸²à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸à¸¥à¸²à¸”          â”‚
â”‚ âœ… à¸„à¸¸à¸¢à¸à¸±à¸šà¸®à¸±à¸™à¸™à¸²à¹à¸šà¸šà¹€à¸ªà¸µà¸¢à¸‡ (Live)    â”‚
â”‚ âœ… à¸ªà¸£à¸¸à¸›à¸ªà¸¸à¸‚à¸ à¸²à¸à¹ƒà¸«à¹‰à¸¥à¸¹à¸à¸«à¸¥à¸²à¸™          â”‚
â”‚                                 â”‚
â”‚ [à¹€à¸£à¸´à¹ˆà¸¡à¸—à¸”à¸¥à¸­à¸‡à¹ƒà¸Šà¹‰à¸Ÿà¸£à¸µ! ğŸ‰]          â”‚
â”‚ [à¸”à¸¹à¹à¸à¹‡à¸„à¹€à¸à¸ˆà¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Screen 3: Morning Check-in (LINE)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸŒ… à¸ªà¸§à¸±à¸ªà¸”à¸µà¸•à¸­à¸™à¹€à¸Šà¹‰à¸²à¸„à¹ˆà¸° à¸„à¸¸à¸“à¸ªà¸¡à¸Šà¸²à¸¢!   â”‚
â”‚                                 â”‚
â”‚ à¸§à¸±à¸™à¸™à¸µà¹‰à¸£à¸¹à¹‰à¸ªà¸¶à¸à¸­à¸¢à¹ˆà¸²à¸‡à¹„à¸£à¸šà¹‰à¸²à¸‡à¸„à¸°?       â”‚
â”‚                                 â”‚
â”‚ [à¸ªà¸šà¸²à¸¢à¸”à¸µ ğŸ˜Š] [à¹„à¸¡à¹ˆà¸„à¹ˆà¸­à¸¢à¸ªà¸šà¸²à¸¢ ğŸ˜”]   â”‚
â”‚ [à¸§à¸±à¸”à¸™à¹‰à¸³à¸•à¸²à¸¥à¹à¸¥à¹‰à¸§ ğŸ©¸]              â”‚
â”‚ [ğŸ™ï¸ à¸„à¸¸à¸¢à¸à¸±à¸šà¸®à¸±à¸™à¸™à¸²]                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Screen 4: Gemini Live Interface (LIFF)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Hanna Live              â”‚
â”‚         à¹€à¸Šà¸·à¹ˆà¸­à¸¡à¸•à¹ˆà¸­à¹à¸¥à¹‰à¸§            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                 â”‚
â”‚                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚         â”‚         â”‚             â”‚
â”‚         â”‚  [ğŸ‘©â€âš•ï¸]  â”‚             â”‚
â”‚         â”‚         â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                 â”‚
â”‚       à¸à¸³à¸¥à¸±à¸‡à¸Ÿà¸±à¸‡...                â”‚
â”‚                                 â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”                 â”‚
â”‚         â”‚ ğŸ¤  â”‚                 â”‚
â”‚         â””â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚     à¸à¸”à¸„à¹‰à¸²à¸‡à¹„à¸¡à¸„à¹Œà¹€à¸à¸·à¹ˆà¸­à¸à¸¹à¸”           â”‚
â”‚     à¸›à¸¥à¹ˆà¸­à¸¢à¹€à¸à¸·à¹ˆà¸­à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡         â”‚
â”‚                                 â”‚
â”‚                                 â”‚
â”‚     [ğŸ“ à¸§à¸²à¸‡à¸ªà¸²à¸¢]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Implementation Status

### âœ… Completed
1. **LINE Bot** - Basic conversation flow
2. **Gemini Live Service** - Real-time voice streaming
3. **Hanna Web (LIFF)** - Voice interface
4. **Database Schema** - Patient and check-in tracking
5. **Onboarding Flow** - 5-step user registration
6. **Payment Integration** - PromptPay QR generation

### ğŸš§ In Progress
1. **Conversation Context** - Memory across turns
2. **Smart Channel Routing** - Auto-suggest Gemini Live
3. **Unified Conversation Log** - Sync LINE + Live

### ğŸ“‹ Planned
1. **Rich Menu** - Permanent buttons for quick access
2. **Family Notifications** - Group chat integration
3. **Nurse Dashboard** - Web interface for monitoring
4. **Emotion Detection** - Voice tone analysis
5. **Video Support** - Visual consultation

---

## ğŸ¯ Conversational Strategy

### Hybrid Model (Recommended)

**LINE Bot** â†’ **Asynchronous Care**
- âœ… Daily scheduled check-ins
- âœ… Medication reminders
- âœ… Health data logging
- âœ… Quick questions
- âœ… Appointment scheduling

**Gemini Live** â†’ **Synchronous Conversations**
- âœ… Real-time consultations
- âœ… Urgent triage
- âœ… Complex symptom discussions
- âœ… Emotional support
- âœ… Detailed health reviews

**Integration Points**:
1. LINE bot detects urgency keywords â†’ Suggests Gemini Live
2. Gemini Live session ends â†’ Summary sent to LINE
3. All conversations logged to database
4. Nurse dashboard shows both channels

---

## ğŸ“ˆ Next Steps

Based on this wireframe, we should prioritize:

1. **Conversation Context** - Add memory to LINE bot (Quick Win)
2. **Smart Routing** - Auto-detect when to use Gemini Live
3. **Unified Logging** - Sync all conversations to database
4. **Rich Menu** - Permanent buttons for quick access
5. **Family Notifications** - Group chat integration
6. **Nurse Dashboard** - Web interface for monitoring

**Key Question**: Should we enhance LINE bot conversational quality or lean into the hybrid model?

**Recommendation**: Embrace hybrid model - each channel optimized for its strengths.

